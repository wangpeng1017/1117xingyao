<svg xmlns="http://www.w3.org/2000/svg" width="1200" height="700" viewBox="0 0 1200 700">
  <defs>
    <style>
      .title { font-family: "Microsoft YaHei", Arial, sans-serif; font-size: 24px; font-weight: bold; fill: #333333; }
      .subtitle { font-family: "Microsoft YaHei", Arial, sans-serif; font-size: 14px; fill: #666666; }
      .box-title { font-family: "Microsoft YaHei", Arial, sans-serif; font-size: 13px; font-weight: bold; fill: #333333; }
      .box-text { font-family: "Microsoft YaHei", Arial, sans-serif; font-size: 12px; fill: #333333; }
      .small-text { font-family: "Microsoft YaHei", Arial, sans-serif; font-size: 11px; fill: #333333; }
    </style>
    <marker id="arrow" markerWidth="10" markerHeight="10" refX="10" refY="3" orient="auto" markerUnits="strokeWidth">
      <path d="M0,0 L10,3 L0,6 Z" fill="#555555" />
    </marker>
  </defs>

  <!-- 背景 -->
  <rect x="0" y="0" width="1200" height="700" fill="#FFFFFF" />

  <!-- 标题 -->
  <text x="600" y="40" text-anchor="middle" class="title">设备智能体整体逻辑架构</text>
  <text x="600" y="65" text-anchor="middle" class="subtitle">
    从现场输入 → 理解与诊断 → 调用业务系统与知识 → 生成方案 → 知识沉淀闭环
  </text>

  <!-- 顶部流程步骤 -->
  <!-- 步骤 1：现场输入 -->
  <rect x="70" y="90" width="170" height="80" rx="8" ry="8" fill="#E8F3FF" stroke="#5B8FF9" stroke-width="1"/>
  <text x="155" y="120" text-anchor="middle" class="box-text">
    <tspan x="155" dy="0">现场输入</tspan>
    <tspan x="155" dy="18">文本 / 语音 / 图片</tspan>
  </text>

  <!-- 步骤 2：自然语言理解 -->
  <rect x="280" y="90" width="170" height="80" rx="8" ry="8" fill="#F7F6FF" stroke="#9270CA" stroke-width="1"/>
  <text x="365" y="120" text-anchor="middle" class="box-text">
    <tspan x="365" dy="0">自然语言理解 NLU</tspan>
    <tspan x="365" dy="18">多轮对话上下文理解</tspan>
  </text>

  <!-- 步骤 3：智能诊断与任务编排 -->
  <rect x="490" y="90" width="170" height="80" rx="8" ry="8" fill="#FFF7E6" stroke="#FA8C16" stroke-width="1"/>
  <text x="575" y="115" text-anchor="middle" class="box-text">
    <tspan x="575" dy="0">智能诊断与对话管理</tspan>
    <tspan x="575" dy="18">动态诊断路径 / 任务编排</tspan>
  </text>

  <!-- 步骤 4：方案生成与推荐 -->
  <rect x="700" y="90" width="170" height="80" rx="8" ry="8" fill="#FFF1F0" stroke="#F5222D" stroke-width="1"/>
  <text x="785" y="115" text-anchor="middle" class="box-text">
    <tspan x="785" dy="0">方案生成与智能推荐</tspan>
    <tspan x="785" dy="18">案例 / SOP / 备件 / 专家提示</tspan>
  </text>

  <!-- 步骤 5：知识沉淀闭环 -->
  <rect x="910" y="90" width="170" height="80" rx="8" ry="8" fill="#F6FFED" stroke="#52C41A" stroke-width="1"/>
  <text x="995" y="115" text-anchor="middle" class="box-text">
    <tspan x="995" dy="0">知识沉淀与持续学习</tspan>
    <tspan x="995" dy="18">自动生成案例 / 盲点分析</tspan>
  </text>

  <!-- 顶部流程箭头 -->
  <line x1="240" y1="130" x2="280" y2="130" stroke="#555555" stroke-width="2" marker-end="url(#arrow)" />
  <line x1="450" y1="130" x2="490" y2="130" stroke="#555555" stroke-width="2" marker-end="url(#arrow)" />
  <line x1="660" y1="130" x2="700" y2="130" stroke="#555555" stroke-width="2" marker-end="url(#arrow)" />
  <line x1="870" y1="130" x2="910" y2="130" stroke="#555555" stroke-width="2" marker-end="url(#arrow)" />

  <!-- 左侧：现场角色与智能对话入口 -->
  <rect x="30" y="230" width="150" height="70" rx="8" ry="8" fill="#E6FFFB" stroke="#13C2C2" stroke-width="1"/>
  <text x="105" y="255" text-anchor="middle" class="box-text">
    <tspan x="105" dy="0">现场工程师</tspan>
    <tspan x="105" dy="18">操作员 / 维修员 / 设备工程师</tspan>
  </text>

  <rect x="30" y="320" width="150" height="80" rx="8" ry="8" fill="#F0F5FF" stroke="#2F54EB" stroke-width="1"/>
  <text x="105" y="345" text-anchor="middle" class="box-text">
    <tspan x="105" dy="0">移动端智能对话组件</tspan>
    <tspan x="105" dy="18">聊天界面 / 语音输入 / 图片上传</tspan>
  </text>

  <!-- 工程师 → 对话组件 → 智能体服务 -->
  <line x1="105" y1="300" x2="105" y2="320" stroke="#555555" stroke-width="2" marker-end="url(#arrow)" />
  <line x1="180" y1="360" x2="220" y2="360" stroke="#555555" stroke-width="2" marker-end="url(#arrow)" />

  <!-- 中部大框：设备智能体服务 -->
  <rect x="200" y="200" width="800" height="270" rx="12" ry="12" fill="#FAFAFA" stroke="#D9D9D9" stroke-width="1.5"/>
  <text x="600" y="225" text-anchor="middle" class="box-title">设备智能体服务（虚拟设备专家）</text>

  <!-- 智能体内部模块：按行展示 -->

  <!-- 行 1：自然语言理解 -->
  <rect x="220" y="250" width="760" height="50" rx="6" ry="6" fill="#FFFFFF" stroke="#D9D9D9" stroke-width="1"/>
  <text x="240" y="275" class="box-title">
    <tspan x="240" dy="0">自然语言理解与多轮对话</tspan>
  </text>
  <text x="240" y="293" class="small-text">
    <tspan x="240" dy="0">解析现场口语化描述，识别设备、故障现象、工艺条件等关键实体，保持工单与对话上下文</tspan>
  </text>

  <!-- 行 2：智能诊断与对话管理 -->
  <rect x="220" y="310" width="760" height="50" rx="6" ry="6" fill="#FFFFFF" stroke="#D9D9D9" stroke-width="1"/>
  <text x="240" y="335" class="box-title">
    <tspan x="240" dy="0">智能诊断与对话管理</tspan>
  </text>
  <text x="240" y="353" class="small-text">
    <tspan x="240" dy="0">结合故障树和历史案例，动态提问澄清，形成类似资深专家的排查路径（如先问现象，再问工况、再引导测量）</tspan>
  </text>

  <!-- 行 3：知识检索与 RAG -->
  <rect x="220" y="370" width="760" height="50" rx="6" ry="6" fill="#FFFFFF" stroke="#D9D9D9" stroke-width="1"/>
  <text x="240" y="395" class="box-title">
    <tspan x="240" dy="0">知识检索与检索增强生成（RAG）</tspan>
  </text>
  <text x="240" y="413" class="small-text">
    <tspan x="240" dy="0">从知识库案例、SOP、图纸等构建向量索引，按相似度检索最相关知识片段，作为大模型回答依据</tspan>
  </text>

  <!-- 行 4：任务编排与方案生成 -->
  <rect x="220" y="430" width="760" height="50" rx="6" ry="6" fill="#FFFFFF" stroke="#D9D9D9" stroke-width="1"/>
  <text x="240" y="455" class="box-title">
    <tspan x="240" dy="0">任务编排与方案生成</tspan>
  </text>
  <text x="240" y="473" class="small-text">
    <tspan x="240" dy="0">统一编排跨系统查询（工单、备件、履历、MES 等），生成可执行诊断步骤、处理方案和建议工单，并回写知识草稿</tspan>
  </text>

  <!-- 左侧对话组件 → 智能体大框 -->
  <line x1="220" y1="360" x2="220" y2="360" stroke="#555555" stroke-width="2" />
  <line x1="220" y1="360" x2="200" y2="360" stroke="none" />

  <!-- 对话组件 → 智能体入口箭头（更清晰连到中框左边中部） -->
  <line x1="180" y1="360" x2="200" y2="360" stroke="#555555" stroke-width="2" marker-end="url(#arrow)" />

  <!-- 右侧：业务微服务与外部系统 -->
  <text x="1100" y="210" text-anchor="middle" class="box-title">业务系统与数据源</text>

  <rect x="1020" y="230" width="160" height="40" rx="6" ry="6" fill="#FFFFFF" stroke="#BFBFBF" stroke-width="1"/>
  <text x="1100" y="255" text-anchor="middle" class="small-text">
    <tspan x="1100" dy="0">维保管理服务</tspan>
    <tspan x="1100" dy="14">报修 / 工单 / 保养 / 巡检</tspan>
  </text>

  <rect x="1020" y="280" width="160" height="40" rx="6" ry="6" fill="#FFFFFF" stroke="#BFBFBF" stroke-width="1"/>
  <text x="1100" y="305" text-anchor="middle" class="small-text">
    <tspan x="1100" dy="0">备件管理服务</tspan>
    <tspan x="1100" dy="14">库存 / 出入库 / 预警</tspan>
  </text>

  <rect x="1020" y="330" width="160" height="40" rx="6" ry="6" fill="#FFFFFF" stroke="#BFBFBF" stroke-width="1"/>
  <text x="1100" y="355" text-anchor="middle" class="small-text">
    <tspan x="1100" dy="0">知识库管理服务</tspan>
    <tspan x="1100" dy="14">维修案例 / SOP / 故障树</tspan>
  </text>

  <rect x="1020" y="380" width="160" height="40" rx="6" ry="6" fill="#FFFFFF" stroke="#BFBFBF" stroke-width="1"/>
  <text x="1100" y="405" text-anchor="middle" class="small-text">
    <tspan x="1100" dy="0">资产管理服务</tspan>
    <tspan x="1100" dy="14">设备台账 / 履历 / 状态</tspan>
  </text>

  <rect x="1020" y="430" width="160" height="40" rx="6" ry="6" fill="#FFFFFF" stroke="#BFBFBF" stroke-width="1"/>
  <text x="1100" y="455" text-anchor="middle" class="small-text">
    <tspan x="1100" dy="0">外部系统</tspan>
    <tspan x="1100" dy="14">MES / IoT / OEE 等</tspan>
  </text>

  <!-- 智能体服务 → 业务系统箭头（代表跨系统问答与操作） -->
  <line x1="1000" y1="275" x2="1020" y2="275" stroke="#555555" stroke-width="1.5" marker-end="url(#arrow)" />
  <line x1="1000" y1="325" x2="1020" y2="325" stroke="#555555" stroke-width="1.5" marker-end="url(#arrow)" />
  <line x1="1000" y1="375" x2="1020" y2="375" stroke="#555555" stroke-width="1.5" marker-end="url(#arrow)" />
  <line x1="1000" y1="425" x2="1020" y2="425" stroke="#555555" stroke-width="1.5" marker-end="url(#arrow)" />
  <line x1="1000" y1="455" x2="1020" y2="455" stroke="#555555" stroke-width="1.5" marker-End="url(#arrow)" />

  <!-- 底部：AI 与数据基础设施 -->
  <text x="600" y="520" text-anchor="middle" class="box-title">AI 与数据基础设施</text>

  <rect x="350" y="540" width="180" height="60" rx="8" ry="8" fill="#FFFFFF" stroke="#BFBFBF" stroke-width="1"/>
  <text x="440" y="565" text-anchor="middle" class="box-text">
    <tspan x="440" dy="0">大语言模型服务</tspan>
    <tspan x="440" dy="18">设备领域微调模型</tspan>
  </text>

  <rect x="510" y="540" width="180" height="60" rx="8" ry="8" fill="#FFFFFF" stroke="#BFBFBF" stroke-width="1"/>
  <text x="600" y="565" text-anchor="middle" class="box-text">
    <tspan x="600" dy="0">向量数据库</tspan>
    <tspan x="600" dy="18">案例 / SOP / 文档向量索引</tspan>
  </text>

  <rect x="670" y="540" width="180" height="60" rx="8" ry="8" fill="#FFFFFF" stroke="#BFBFBF" stroke-width="1"/>
  <text x="760" y="565" text-anchor="middle" class="box-text">
    <tspan x="760" dy="0">多模态模型（可选）</tspan>
    <tspan x="760" dy="18">图片 / 声音辅助诊断</tspan>
  </text>

  <!-- 智能体 → AI 基础设施箭头 -->
  <line x1="510" y1="500" x2="440" y2="540" stroke="#555555" stroke-width="1.5" marker-end="url(#arrow)" />
  <line x1="600" y1="500" x2="600" y2="540" stroke="#555555" stroke-width="1.5" marker-end="url(#arrow)" />
  <line x1="690" y1="500" x2="760" y2="540" stroke="#555555" stroke-width="1.5" marker-end="url(#arrow)" />

  <!-- 知识库服务 → 向量数据库（离线构建与持续更新） -->
  <line x1="1100" y1="370" x2="600" y2="540" stroke="#AAAAAA" stroke-dasharray="4 4" stroke-width="1.2" marker-end="url(#arrow)" />
  <text x="830" y="455" text-anchor="middle" class="small-text">知识入库与向量化更新</text>

  <!-- 顶部步骤 → 中部智能体总览说明（虚线连接） -->
  <line x1="575" y1="170" x2="575" y2="200" stroke="#AAAAAA" stroke-dasharray="4 4" stroke-width="1"/>
  <line x1="785" y1="170" x2="785" y2="200" stroke="#AAAAAA" stroke-dasharray="4 4" stroke-width="1"/>
  <line x1="995" y1="170" x2="995" y2="200" stroke="#AAAAAA" stroke-dasharray="4 4" stroke-width="1"/>
</svg>
